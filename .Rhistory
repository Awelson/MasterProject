if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("biomaRt")
install.packages("Rtools")
install.packages("rmarkdown")
install.packages("knitr")
install.packages("posterdown")
write.csv(file = "CRCfinal.csv", CRCfinal, row.names = FALSE)
setwd("C:/Users/aaron/Desktop/Github Projects/MasterProject/scripts")
setwd("C:/Users/aaron/Desktop/Github Projects/MasterProject/scripts")
library(readr)
CRCfinal <- read_csv("C:/Users/aaron/Desktop/Github Projects/MasterProject/RawData/Processed/CRCfinal.csv")
View(CRCfinal)
library(readr)
D0final <- read_csv("C:/Users/aaron/Desktop/Github Projects/MasterProject/RawData/Processed/D0final.csv")
View(D0final)
library(readr)
D1final <- read_csv("C:/Users/aaron/Desktop/Github Projects/MasterProject/RawData/Processed/D1final.csv")
View(D1final)
library(readr)
D2final <- read_csv("C:/Users/aaron/Desktop/Github Projects/MasterProject/RawData/Processed/D2final.csv")
View(D2final)
write.csv(file = "CRCfinal.csv", CRCfinal %>% select(-1), row.names = FALSE)
library(plyr)
library(tidyverse)
library(purrr)
write.csv(file = "CRCfinal.csv", CRCfinal %>% select(-1), row.names = FALSE)
write.csv(file = "D0final.csv", D0final %>% select(-1), row.names = FALSE)
write.csv(file = "D1final.csv", D1final %>% select(-1), row.names = FALSE)
write.csv(file = "D2final.csv", D2final %>% select(-1), row.names = FALSE)
View(D0final)
View(CRCfinal)
View(D1final)
View(D0final)
D0final <- D0final %>% rename(Allele = Allele...8)
View(D0final)
View(D1final)
View(D1final)
View(D2final)
View(D1final)
View(D2final)
write.csv(file = "CRCfinal.csv", CRCfinal %>% select(-1, -11), row.names = FALSE)
write.csv(file = "D0final.csv", D0final %>% select(-1, -11), row.names = FALSE)
write.csv(file = "D1final.csv", D1final %>% select(-1, -11), row.names = FALSE)
write.csv(file = "D2final.csv", D2final %>% select(-1, -11), row.names = FALSE)
setwd("C:/Users/aaron/Desktop/Github Projects/MasterProject")
library(tidyverse)
library(purrr)
library(magrittr)
library(reshape2)
library(plyr)
library(dplyr)
source("Scripts/ReadFolder2.R")
source("Scripts/ReadFolder3.R")
FilePaths <- list.files("RawData/EC/ManUMI/20220622", full.names=TRUE)
FIlePaths
FilePaths
FilePathD0 <- list.files("RawData/EC/ManUMI/20220622/D0", full.names=TRUE)
FilePathD1 <- list.files("RawData/EC/ManUMI/20220622/D1", full.names=TRUE)
FilePathD2 <- list.files("RawData/EC/ManUMI/20220622/D2", full.names=TRUE)
FilePathD0
NewNames <- list.files("RawData/EC/Man/20220425.24", full.names=TRUE)
NewNmaes
NewNames
NewNames <- list.files("RawData/EC/Man/20220425.24", full.names=FALSE)
NewNames
NewPathD0 <- file.path(dirname(FilePathD0), NewNames)
NewPathD1 <- file.path(dirname(FilePathD1), NewNames)
NewPathD2 <- file.path(dirname(FilePathD2), NewNames)
NewPathD0
file.rename(FilePathD0, NewPathD0)
file.rename(FilePathD1, NewPathD1)
file.rename(FilePathD2, NewPathD2)
FilePathD0
FilePathD0 <- list.files("RawData/EC/ManUMI/20220622/D0", full.names=FALSE)
FilePathD0 <- list.files("RawData/EC/ManUMI/20220622oldname/D0", full.names=FALSE)
FilePathD0
FilePathD0new <- list.files("RawData/EC/ManUMI/20220622/D0", full.names=FALSE)
FilePathD0old <- list.files("RawData/EC/ManUMI/20220622oldname/D0", full.names=FALSE)
FilePathD0old
FilePathD0new
ECMAN <- ReadFolder2("RawData/EC/MANUMI/20220622")
View(ECMAN)
View(ECMAN)
ECMAN$L2 <- NA
ECMAN$L3 <- NA
ECMAN$Dataset <- "Man"
ECMAN$Type <- "EC"
ECMAN <- left_join(MAN, x, by = "SampleName")
ECMAN <- left_join(ECMAN, x, by = "SampleName")
x <- read.csv("RawData/EC/ManUMI/Manchester.EC.Samples.20240111.csv")
x %<>% select(SequencingID, Type)
x %<>% rename(c("SequencingID" = "SampleName", "Type" = "L1"))
ECMAN <- left_join(ECMAN, x, by = "SampleName")
View(ECMAN)
View(ECMAN)
View(ECMAN)
Ohio1 <- ReadFolder2("RawData/EC/OhioUMI/20220318")
Ohio2 <- ReadFolder2("RawData/EC/OhioUMI/20220401")
test1 <- unique(Ohio1$SampleName)
test2 <- unique(Ohio2$SampleName)
intesect(test1, test2)
intersect(test1, test2)
Ohio <- bind_rows(Ohio1, Ohio2)
Ohio$L2 <- NA
Ohio$L3 <- NA
View(Ohio)
Ohio$Dataset <- "Ohio"
Ohio$Type <- "EC"
test3 <- unique(ECMAN$SampleName)
intersect(test1, test3)
intersect(test2, test3)
x <- read.csv("RawData/EC/OhioUMI/Ohio.SampleData.20240111.csv")
x %<>% select(SequencingID, Type)
x %<>% rename(c("SequencingID" = "SampleName", "Type" = "L1"))
x$L1 <- replacement[x$L1]
Ohio$L2 <- NA
Ohio$L3 <- NA
Ohio$Dataset <- "Ohio"
Ohio$Type <- "EC"
replacement <- c("MSS" = "MMRp", "MSI" = "MMRd")
x$L1 <- replacement[x$L1]
x <- read.csv("RawData/EC/OhioUMI/Ohio.SampleData.20240111.csv")
x %<>% select(SequencingID, Type)
x %<>% rename(c("SequencingID" = "SampleName", "Type" = "L1"))
x$L1 <- replacement[x$L1]
Ohio <- left_join(Ohio, x, by = "SampleName")
View(Ohio)
Jenny <- ReadFolder2("RawData/OGCRC/UMImsiMNRsJenny210421")
View(Jenny)
Jenny$L2 <- NA
Jenny$L3 <- NA
Jenny$Dataset <- "Jenny"
Jenny$Type <- "CRC"
x <- read.csv("RawData/OGCRC/Data.Jenny.Coding.csv")
View(x)
x2 <- read.csv("RawData/OGCRC/LS.samples.annotation.csv")
View(x)
View(x2)
x1 <- read.csv("RawData/OGCRC/Data.Jenny.Coding.csv")
Jenny$L2 <- NA
Jenny$L3 <- NA
Jenny$Dataset <- "Jenny"
Jenny$Type <- "CRC"
test1 <- unique(x1$sample)
test2 <- unique(Jenny$SampleName)
test1
test2
intersect(test1, test2)
test3 <- unique(x2$Sample)
intersect(test3, test2)
x <- read.csv("RawData/OGCRC/LS.CRCs.BRAF.csv")
test1 <- unique(x$Sample)
test2 <- unique(Jenny$SampleName)
intersect(test1, test2)
length(intesect(test1,test2))
length(intersect(test1,test2))
length(test2)
setdiff(test2, intersect(test1,test2))
length(test1)
test1
Jenny$SampleName <- gsub("258136A4", "258136", Jenny$SampleName)
Jenny$SampleName <- gsub("269965B7", "269965", Jenny$SampleName)
test1 <- unique(x$Sample)
test2 <- unique(Jenny$SampleName)
test2 %>% length()
intersect(test1, test2) %>% length()
x <- read.csv("RawData/EC/OhioUMI/Ohio.SampleData.20240111.csv")
x %<>% select(SequencingID, Type)
x %<>% rename(c("SequencingID" = "SampleName", "Type" = "L1"))
x$L1 <- replacement[x$L1]
ECOhio1 <- ReadFolder2("RawData/EC/OhioUMI/20220318")
ECOhio2 <- ReadFolder2("RawData/EC/OhioUMI/20220401")
ECOhio <- bind_rows(ECOhio1, ECOhio2)
ECOhio$L2 <- NA
ECOhio$L3 <- NA
ECOhio$Dataset <- "Ohio"
ECOhio$Type <- "EC"
test1 <- ECOhio$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2)
intersect(test1, test2) %>% length()
test1 %>% length()
x <- read.csv("RawData/OGCRC/LS.CRCs.BRAF.csv")
View(x)
View(x)
x %<>% select(Sample, Type)
x <- read.csv("RawData/OGCRC/LS.CRCs.BRAF.csv")
x %<>% select(Sample, Type)
x %<>% rename(c("Sample" = "SampleName", "Type" = "L1"))
View(x)
View(x)
View(x)
View(x)
x$L1 <- gsub("LS MSI-H", "MMRd", x$L1)
x$L1 <- gsub("MSI-H", "MMRd", x$L1)
x$L1 <- gsub("MSS", "MMRp", x$L1)
test1 <- Jenny$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length()
test1 %>% length()
x <- read.csv("RawData/EC/ManUMI/Manchester.EC.Samples.20240111.csv")
x %<>% select(SequencingID, Type)
x %<>% rename(c("SequencingID" = "SampleName", "Type" = "L1"))
test1 <- ECMAN$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length()
test1 %>% length()
View(ECMAN)
test2 %>% length()
setdiff(test1, test2)
test2
x <- readRDS("RawData/CMMRD/SampleData.20220204.v2.rds")
x %<>% select(Sample, Genotype, Gene)
x %<>% rename(c("Sample" = "SampleName", "Gene" = "L1", "Genotype" = "L2"))
x %<>% mutate(L1 = if_else(L1 == "Control", "MMRp", "MMRd"), L2 = if_else(L2 == "Control", NA, L2))
test1 <- CMMRD$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length() # 151
CMMRD <- ReadFolder2("RawData/CMMRD/byUmiGenotypesRearranged")
CMMRD <- left_join(CMMRD, x, by = "SampleName")
CMMRD$L3 <- NA
test1 <- CMMRD$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length() # 151
test1 %>% length() # 167, 16 missing
x <- read.csv("RawData/NEWCRC/Tumours.20190923.csv")
x %<>% select(Sample, Type)
x %<>% rename(c("Sample" = "SampleName", "Type" = "L1"))
replacement <- c("MSS" = "MMRp", "MSI" = "MMRd")
x$L1 <- replacement[x$L1]
## there are duplicates in the phenotype csv for some reason
x %<>% distinct
test1 <- CRC1$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
CRC1 <- ReadFolder2("RawData/NEWCRC/20170501")
CRC1$L2 <- NA
CRC1$L3 <- NA
CRC1$Dataset <- "CRC1"
CRC1$Type <- "CRC"
test1 <- CRC1$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length() # 139
test1 %>% length() # 139, MATCH!
CRC2 <- ReadFolder2("RawData/NEWCRC/20170809")
CRC2 <- CRC2[CRC2$SampleName != "D227036", ] # removing D227036 in CRC2 (it is present in both CRC1 and CRC2)
test1 <- CRC2$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length() # 98
test1 %>% length() # 98, MATCH!
unique(CRC1$SampleName)
unique(CRC2$SampleName)
intersect(CRC1$SampleName %>% unique(), CRC2$SampleName %>% unique())
setwd("C:/Users/aaron/Desktop/Github Projects/MasterProject")
library(tidyverse)
library(purrr)
library(magrittr)
library(reshape2)
library(plyr)
library(dplyr)
source("Scripts/ReadFolder2.R")
# CRC1, CRC2 Phenotype
x <- read.csv("RawData/NEWCRC/Tumours.20190923.csv")
x %<>% select(Sample, Type)
x %<>% rename(c("Sample" = "SampleName", "Type" = "L1"))
replacement <- c("MSS" = "MMRp", "MSI" = "MMRd")
x$L1 <- replacement[x$L1]
## there are duplicates in the phenotype csv for some reason
x %<>% distinct
# CRC1
CRC1 <- ReadFolder2("RawData/NEWCRC/20170501")
CRC1$L2 <- NA
CRC1$L3 <- NA
CRC1$Dataset <- "CRC1"
CRC1$Type <- "CRC"
## Missing Sample Check
test1 <- CRC1$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length() # 98
test1 %>% length() # 98, MATCH!
CRC1 <- left_join(CRC1, x, by = "SampleName")
# CRC2
CRC2 <- ReadFolder2("RawData/NEWCRC/20170809")
CRC2 <- CRC2[CRC2$SampleName != "D227036", ] # removing D227036 in CRC2 (it is present in both CRC1 and CRC2)
## Missing Sample Check
test1 <- CRC2$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length() # 98
test1 %>% length() # 98, MATCH!
CRC2 <- left_join(CRC2, x, by = "SampleName")
CRC2$L2 <- NA
CRC2$L3 <- NA
CRC2$Dataset <- "CRC2"
CRC2$Type <- "CRC"
# CMMRD Phenotype
x <- readRDS("RawData/CMMRD/SampleData.20220204.v2.rds")
x %<>% select(Sample, Genotype, Gene)
x %<>% rename(c("Sample" = "SampleName", "Gene" = "L1", "Genotype" = "L2"))
x %<>% mutate(L1 = if_else(L1 == "Control", "MMRp", "MMRd"), L2 = if_else(L2 == "Control", NA, L2))
# CMMRD
CMMRD <- ReadFolder2("RawData/CMMRD/byUmiGenotypesRearranged")
CMMRD <- left_join(CMMRD, x, by = "SampleName")
CMMRD$L3 <- NA
## Missing Sample Check
test1 <- CMMRD$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length() # 139
test1 %>% length() # 139, MATCH!
CMMRD$Dataset <- "CMMRD"
CMMRD$Type <- "CMMRD"
# EC (MAN) Phenotype
x <- read.csv("RawData/EC/ManUMI/Manchester.EC.Samples.20240111.csv")
x %<>% select(SequencingID, Type)
x %<>% rename(c("SequencingID" = "SampleName", "Type" = "L1"))
# EC (MAN)
ECMAN <- ReadFolder2("RawData/EC/MANUMI/20220622")
ECMAN$L2 <- NA
ECMAN$L3 <- NA
ECMAN$Dataset <- "Man"
ECMAN$Type <- "EC"
test1 <- ECMAN$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length() # 151
test1 %>% length() # 167, 16 missing
setdiff(test1, test2) # samples w/o phenotype
ECMAN <- ECMAN[!(ECMAN$SampleName %in% setdiff(test1, test2)), ] # remove samples w/o phenotype
ECMAN <- left_join(ECMAN, x, by = "SampleName")
# EC (Ohio) Phenotype
x <- read.csv("RawData/EC/OhioUMI/Ohio.SampleData.20240111.csv")
x %<>% select(SequencingID, Type)
x %<>% rename(c("SequencingID" = "SampleName", "Type" = "L1"))
x$L1 <- replacement[x$L1]
# EC (Ohio)
ECOhio1 <- ReadFolder2("RawData/EC/OhioUMI/20220318")
ECOhio2 <- ReadFolder2("RawData/EC/OhioUMI/20220401")
ECOhio <- bind_rows(ECOhio1, ECOhio2)
ECOhio$L2 <- NA
ECOhio$L3 <- NA
ECOhio$Dataset <- "Ohio"
ECOhio$Type <- "EC"
test1 <- ECOhio$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length() # 184
test1 %>% length() # 184, MATCH!
ECOhio <- left_join(ECOhio, x, by = "SampleName")
# Jenny Phenotype
x <- read.csv("RawData/OGCRC/LS.CRCs.BRAF.csv")
x %<>% select(Sample, Type)
x %<>% rename(c("Sample" = "SampleName", "Type" = "L1"))
x$L1 <- gsub("LS MSI-H", "MMRd", x$L1)
x$L1 <- gsub("MSI-H", "MMRd", x$L1)
x$L1 <- gsub("MSS", "MMRp", x$L1)
# JENNY
Jenny <- ReadFolder2("RawData/OGCRC/UMImsiMNRsJenny210421")
Jenny$L2 <- NA
Jenny$L3 <- NA
Jenny$Dataset <- "Jenny"
Jenny$Type <- "CRC"
## Renaming Samples
Jenny$SampleName <- gsub("258136A4", "258136", Jenny$SampleName)
Jenny$SampleName <- gsub("269965B7", "269965", Jenny$SampleName)
## Missing Sample Check
test1 <- Jenny$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length() # 128
test1 %>% length() # 128, MATCH!
Jenny <- left_join(Jenny, x, by = "SampleName")
All <- bind_rows(Jenny, CRC1, CRC2, CMMRD, ECMAN, ECOhio)
All <- All[, c("SampleName", "Marker", "Allele (length)", "Allele (SNP)", "Counts", "UMI", "L1", "L2", "L3", "Dataset", "Type")]
View(All)
View(All)
is.na(All$L1)
all(is.na(All$L1))
any(is.na(All$L1))
NoL1 <- All[is.na(All$L1), ]
View(NoL1)
x <- read.csv("RawData/NEWCRC/Tumours.20190923.csv")
x %<>% select(Sample, Type)
x %<>% rename(c("Sample" = "SampleName", "Type" = "L1"))
replacement <- c("MSS" = "MMRp", "MSI" = "MMRd")
x$L1 <- replacement[x$L1]
## there are duplicates in the phenotype csv for some reason
x %<>% distinct
test1 <- CRC1$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length() # 98
test1 %>% length() # 98, MATCH!
View(x)
View(x)
View(x)
x <- x[!is.na(x$L1), ]
test1 <- CRC1$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length() # 98
test1 %>% length() # 98, MATCH!
test1 <- CRC2$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length() # 98
test1 %>% length() # 98, MATCH!
View(NoL1)
# CRC1, CRC2 Phenotype
x <- read.csv("RawData/NEWCRC/Tumours.20190923.csv")
x %<>% select(Sample, Type)
x %<>% rename(c("Sample" = "SampleName", "Type" = "L1"))
replacement <- c("MSS" = "MMRp", "MSI" = "MMRd")
x$L1 <- replacement[x$L1]
x %<>% distinct # there are duplicates in the phenotype csv for some reason
x <- x[!is.na(x$L1), ]
# CRC1
CRC1 <- ReadFolder2("RawData/NEWCRC/20170501")
CRC1$L2 <- NA
CRC1$L3 <- NA
CRC1$Dataset <- "CRC1"
CRC1$Type <- "CRC"
## Missing Sample Check
test1 <- CRC1$SampleName %>% unique()
test2 <- x$SampleName %>% unique()
intersect(test1, test2) %>% length() # 96
test1 %>% length() # 98, 2 samples w/o phenotype
setdiff(test1, test2) # samples w/o phenotype
CRC1 <- CRC1[!(CRC1$SampleName %in% setdiff(test1, test2)), ] # remove samples w/o phenotype
CRC1 <- left_join(CRC1, x, by = "SampleName")
All <- bind_rows(Jenny, CRC1, CRC2, CMMRD, ECMAN, ECOhio)
All <- All[, c("SampleName", "Marker", "Allele (length)", "Allele (SNP)", "Counts", "UMI", "L1", "L2", "L3", "Dataset", "Type")]
NoL1 <- All[is.na(All$L1), ]
test <- All %>% group_by(SampleName, `Allele (length)`, Marker, UMI, L1, L2, L3, Dataset) %>%
reframe(
Counts = sum(Counts))
test <- test %>% filter(test$`Allele (length)` == 0 & test$Counts == 0)
View(test)
View(test)
View(test)
test1 <- All %>% filer(All$SampleName == "ECV81" & All$UMI == "D1")
test1 <- All %>% filter(All$SampleName == "ECV81" & All$UMI == "D1")
View(test)
View(test1)
View(test)
test1 <- All %>% filter(All$SampleName == "OhioECV81" & All$UMI == "D1")
View(test1)
test1 <- All %>% filter(All$SampleName == "OhioECV81")
View(test)
View(test1)
test$SampleName %>% unique # weird samples
OhioECT159 <- All %>% filter(All$SampleName == "OhioECT159") # is basically empty, BAD
View(OhioECT159)
View(test)
OhioECV48 <- All %>% filter(All$SampleName == "OhioECV48")
View(OhioECV48)
OhioECT181 <- All %>% filter(All$SampleName == "OhioECT181") # Good
View(OhioECT181)
LO408 <- All %>% filter(All$SampleName == "LO408")
View(LO408)
L0408 <- All %>% filter(All$SampleName == "L0408")
View(L0408)
PET103 <- All %>% filter(All$SampleName == "PET103") # Good
View(PET103)
View(OhioECT159)
View(PET103)
View(OhioECT159)
test <- All %>% group_by(SampleName, `Allele (length)`, Marker, UMI, L1, L2, L3, Dataset) %>%
reframe(
Counts = sum(Counts))
test <- All %>% group_by(SampleName, `Allele (length)`, Marker, UMI, L1, L2, L3, Dataset, Type) %>%
reframe(
Counts = sum(Counts))
test1 <- test %>% group_by(SampleName, Marker, UMI, L1, L2, L3, Dataset, Type) %>%
reframe(
Total = sum(Counts))
View(test1)
test1 <- test %>% group_by(SampleName, Marker, UMI, L1, L2, L3, Dataset, Type) %>%
reframe(
`Allele (length)`= `Allele (length)`,
Total = sum(Counts))
View(test1)
test1 <- test %>% group_by(SampleName, Marker, UMI, L1, L2, L3, Dataset, Type) %>%
reframe(
`Allele (length)`= `Allele (length)`,
Counts = Counts,
Total = sum(Counts))
View(test1)
OhioECT181 <- All %>% filter(All$SampleName == "OhioECT181") # basically empty, BAD
checkobservation <- function(Sample){
table <- All %>% filter(All$SampleName == Sample)
return(nrow(table))
}
checkobservation("OhioECV81")
sapply(SampleList, checkobservation)
SampleList <- All$SampleName %>% unique()
sapply(SampleList, checkobservation)
SampleList
lapply(SampleList, checkobservation)
unlist(lapply(SampleList, checkobservation))
df <- data.frame(
SampleName = SampleList,
Observations = unlist(lapply(SampleList, checkobservation))
)
View(df)
All <- All[!(All$SampleName %in% c("OhioECV81", "OhioECT181")), ]
write.csv(All, "Data/withSNP/All.csv", row.names = FALSE)
View(All)
